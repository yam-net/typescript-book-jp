* [çŸ¢å°æ©Ÿèƒ½](#arrow-functions)
* [ãƒ’ãƒ³ãƒˆï¼šçŸ¢å°æ©Ÿèƒ½ãŒå¿…è¦](#tip-arrow-function-need)
* [Tipï¼šçŸ¢å°æ©Ÿèƒ½ã®å±é™ºæ€§](#tip-arrow-function-danger)
* [ãƒ’ãƒ³ãƒˆï¼š `this`ã‚’ä½¿ç”¨ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª](#tip-arrow-functions-with-libraries-that-use-this)
* [ãƒ’ãƒ³ãƒˆï¼šçŸ¢å°é–¢æ•°ã®ç¶™æ‰¿](#tip-arrow-functions-and -herher)
* [ãƒ’ãƒ³ãƒˆï¼šã‚¯ã‚¤ãƒƒã‚¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒªã‚¿ãƒ¼ãƒ³](#tip-quick-object-return)

### çŸ¢å°é–¢æ•°

* å¤ªã„çŸ¢å°*(è–„ã„çŸ¢å°ã§ `=>`ã¯å¤ªã„çŸ¢å°ã§ã‚ã‚‹)ã¨lambdaé–¢æ•°*(ä»–ã®è¨€èªã®ãŸã‚)ã¨ã‚‚å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚åˆ¥ã®ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã‚‹æ©Ÿèƒ½ã¯å¤ªã„çŸ¢å°é–¢æ•° `()=> something`ã§ã™ã€‚ *å¤ªã£ãŸçŸ¢å°*ã®å‹•æ©Ÿã¯ï¼š
1. ã‚ãªãŸã¯ `function`ã‚’ã‚¿ã‚¤ãƒ—ã—ç¶šã‘ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“
2. ãã‚Œã¯ã€Œã“ã‚Œã€ã®æ„å‘³ã‚’èªå½™çš„ã«æ•æ‰ã™ã‚‹
2. ã€Œè­°è«–ã€ã®æ„å‘³ã‚’èªå½™çš„ã«æ•æ‰ã™ã‚‹

æ©Ÿèƒ½çš„ã§ã‚ã‚‹ã¨ä¸»å¼µã™ã‚‹è¨€èªã®å ´åˆã€JavaScriptã§ã¯ `function`ã‚’ã‹ãªã‚Šå¤šãå…¥åŠ›ã™ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚å¤ªã„çŸ¢å°ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€é–¢æ•°ã‚’ç°¡å˜ã«ä½œæˆã§ãã¾ã™
```ts
var inc = (x)=>x+1;
```
ã€Œã“ã‚Œã¯ã€å¾“æ¥ã€JavaScriptã®è‹¦åŠ´ã—ã¦ããŸã“ã¨ã§ã™ã€‚è³¢æ˜ãªäººã¯ã€ã€Œç§ã¯JavaScriptãŒå«Œã„ã§ã™ãŒã€ã“ã‚Œã¯ã€Œã“ã®ã™ã¹ã¦ã€ã®æ„å‘³ã‚’ã‚ã¾ã‚Šã«ã‚‚ç°¡å˜ã«å¤±ã†å‚¾å‘ãŒã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚è„‚è‚ªæ—ã®çŸ¢ã¯ã€å‘¨å›²ã®æ–‡è„ˆã‹ã‚‰ `this`ã®æ„å‘³ã‚’æ‰ãˆã¦ä¿®æ­£ã—ã¾ã™ã€‚ã“ã®ç´”ç²‹ãªJavaScriptã‚¯ãƒ©ã‚¹ã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```ts
function Person(age) {
    this.age = age;
    this.growOld = function() {
        this.age++;
    }
}
var person = new Person(1);
setTimeout(person.growOld,1000);

setTimeout(function() { console.log(person.age); },2000); // 1, should have been 2
```
ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§å®Ÿè¡Œã™ã‚‹ã¨ã€é–¢æ•°å†…ã® `this`ã¯`window`ã‚’æŒ‡ã™ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ãªãœãªã‚‰ã€ `window`ã¯`growOld`é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã‚‚ã®ã«ãªã‚‹ã‹ã‚‰ã§ã™ã€‚ä¿®æ­£ã¯ã€çŸ¢å°é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ï¼š
```ts
function Person(age) {
    this.age = age;
    this.growOld = () => {
        this.age++;
    }
}
var person = new Person(1);
setTimeout(person.growOld,1000);

setTimeout(function() { console.log(person.age); },2000); // 2
```
ã“ã‚ŒãŒãªãœæ©Ÿèƒ½ã™ã‚‹ã®ã‹ã¯ã€é–¢æ•°æœ¬ä½“ã®å¤–å´ã‹ã‚‰ã®çŸ¢å°é–¢æ•°ã«ã‚ˆã£ã¦ 'this'ã¸ã®å‚ç…§ãŒæ•æ‰ã•ã‚Œã‚‹ãŸã‚ã§ã™ã€‚ã“ã‚Œã¯æ¬¡ã®JavaScriptã‚³ãƒ¼ãƒ‰ã¨åŒã˜ã§ã™(TypeScriptã‚’ä½¿ç”¨ã—ã¦ã„ãªã„å ´åˆã¯ã€è‡ªåˆ†ã§æ›¸ãã¨æ€ã„ã¾ã™)ã€‚
```ts
function Person(age) {
    this.age = age;
    var _this = this;  // capture this
    this.growOld = function() {
        _this.age++;   // use the captured this
    }
}
var person = new Person(1);
setTimeout(person.growOld,1000);

setTimeout(function() { console.log(person.age); },2000); // 2
```
TypeScriptã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§ã€æ§‹æ–‡ãŒç”˜ããªã‚Šã€çŸ¢å°ã‚’ã‚¯ãƒ©ã‚¹ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```ts
class Person {
    constructor(public age:number) {}
    growOld = () => {
        this.age++;
    }
}
var person = new Person(1);
setTimeout(person.growOld,1000);

setTimeout(function() { console.log(person.age); },2000); // 2
```

> [ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦ã®ç”˜ã„ãƒ“ãƒ‡ã‚ªğŸŒ¹](https://egghead.io/lessons/typescript-make-usages-of-this-safe-in-class-methods)

#### ãƒ’ãƒ³ãƒˆï¼šçŸ¢å°æ©Ÿèƒ½ãŒå¿…è¦
ç°¡æ½”ãªæ§‹æ–‡ã®ã»ã‹ã«ã€ä»–ã®äººã«é–¢æ•°ã‚’æ¸¡ã™å ´åˆã¯å¤ªã„çŸ¢å°ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚åŠ¹æœçš„ã«ï¼š
```ts
var growOld = person.growOld;
// Then later someone else calls it:
growOld();
```
ã‚ãªãŸãŒãã‚Œã‚’è‡ªåˆ†ã§å‘¼ã³å‡ºã™å ´åˆã€ã¤ã¾ã‚Š
```ts
person.growOld();
```
`this`ã¯æ­£ã—ã„å‘¼ã³å‡ºã—ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ(ã“ã®ä¾‹ã§ã¯`person`)ã«ãªã‚Šã¾ã™ã€‚

#### ãƒ’ãƒ³ãƒˆï¼šçŸ¢å°æ©Ÿèƒ½ã®å±é™º

å®Ÿéš›ã« `this`*ã‚’å‘¼ã³å‡ºã—ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ã—ãŸã„å ´åˆã¯*çŸ¢å°é–¢æ•°*ã‚’ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚ jqueryã€underscoreã€mochaãªã©ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ä½¿ç”¨ã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®ã‚±ãƒ¼ã‚¹ã§ã™ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒ `this`ã®é–¢æ•°ã‚’è¨˜è¿°ã—ã¦ã„ã‚‹å ´åˆã¯ã€ãŸã¶ã‚“å¤ªã„çŸ¢å°ã®ä»£ã‚ã‚Šã«`function`ã‚’ä½¿ã†ã¹ãã§ã—ã‚‡ã†ã€‚åŒæ§˜ã«ã€ `arguments`ã‚’ä½¿ç”¨ã™ã‚‹äºˆå®šã®å ´åˆã¯ã€çŸ¢å°é–¢æ•°ã‚’ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚

#### ãƒ’ãƒ³ãƒˆï¼š `this`ã‚’ä½¿ç”¨ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æŒã¤Arrowé–¢æ•°
å¤šãã®å›³æ›¸é¤¨ãŒã“ã‚Œã‚’è¡Œã£ã¦ã„ã‚‹ã€‚ `jQuery`iterables(ã‚ã‚‹ä¾‹ã§ã¯https://api.jquery.com/jquery.each/)ã¯` it`ã‚’ä½¿ã£ã¦ç¾åœ¨åå¾©ä¸­ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã—ã¾ã™ã€‚ã“ã®å ´åˆã€æ¸¡ã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¼ã« `this`ã ã‘ã§ãªãå‘¨å›²ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ã‚‚ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã„å ´åˆã¯ã€çŸ¢å°é–¢æ•°ãŒãªã„å ´åˆã¨åŒæ§˜ã«`_self`ã®ã‚ˆã†ãªä¸€æ™‚å¤‰æ•°ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

```ts
let _self = this;
something.each(function() {
    console.log(_self); // the lexically scoped value
    console.log(this); // the library passed value
});
```

#### ãƒ’ãƒ³ãƒˆï¼šçŸ¢å°æ©Ÿèƒ½ã¨ç¶™æ‰¿
çŸ¢å°ã®é–¢æ•°ã¯ã‚¯ãƒ©ã‚¹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã—ã¦ç¶™æ‰¿ã§æ­£å¸¸ã«å‹•ä½œã—ã¾ã™ï¼š

```ts
class Adder {
    constructor(public a: number) {}
    add = (b: number): number => {
        return this.a + b;
    }
}
class Child extends Adder {
    callAdd(b: number) {
        return this.add(b);
    }
}
// Demo to show it works
const child = new Child(123);
console.log(child.callAdd(123)); // 246
```

ã—ã‹ã—ã€å­ã‚¯ãƒ©ã‚¹ã®é–¢æ•°ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ `super`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ã¯å‹•ä½œã—ã¾ã›ã‚“ã€‚ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ `this`ã«è¡Œãã¾ã™ã€‚ã“ã®ã‚ˆã†ãªé–¢æ•°ã¯ `super`(`super`ã¯ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã®ã¿ã§å‹•ä½œã—ã¾ã™)ã¸ã®å‘¼ã³å‡ºã—ã«ã¯å‚åŠ ã§ãã¾ã›ã‚“ã€‚ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å­ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã™ã‚‹å‰ã«ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ç°¡å˜ã«å›é¿ã§ãã¾ã™ã€‚

```ts
class Adder {
    constructor(public a: number) {}
    // This function is now safe to pass around
    add = (b: number): number => {
        return this.a + b;
    }
}

class ExtendedAdder extends Adder {
    // Create a copy of parent before creating our own
    private superAdd = this.add;
    // Now create our override
    add = (b: number): number => {
        return this.superAdd(b);
    }
}
```

### ãƒ’ãƒ³ãƒˆï¼šã‚¯ã‚¤ãƒƒã‚¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒªã‚¿ãƒ¼ãƒ³

å˜ç´”ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒ†ãƒ©ãƒ«ã‚’è¿”ã™é–¢æ•°ãŒå¿…è¦ãªå ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ä½•ã‹ã®ã‚ˆã†ãª

```ts
// WRONG WAY TO DO IT
var foo = () => {
    bar: 123
};
```
JavaScriptãƒ©ãƒ³ã‚¿ã‚¤ãƒ (JavaScriptä»•æ§˜ã®åŸå› )ã«ã‚ˆã£ã¦* JavaScript Label *ã‚’å«ã‚€*ãƒ–ãƒ­ãƒƒã‚¯*ã¨ã—ã¦è§£æã•ã‚Œã¾ã™ã€‚

> ã“ã‚ŒãŒæ„å‘³ã‚’ãªã•ãªã„å ´åˆã¯ã€ã¨ã«ã‹ã "æœªä½¿ç”¨ã®ãƒ©ãƒ™ãƒ«"ã¨è¨€ã£ã¦ã„ã‚‹ã‚¿ã‚¤ãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‹ã‚‰ã®ç´ æ™´ã‚‰ã—ã„ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã®ã§ã€å¿ƒé…ã—ãªã„ã§ãã ã•ã„ã€‚ãƒ©ãƒ™ãƒ«ã¯å¤ã„(ãã—ã¦ã»ã¨ã‚“ã©ã¯ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„)JavaScriptæ©Ÿèƒ½ã§ã€ç¾ä»£ã®GOTO(çµŒé¨“è±Šå¯Œãªé–‹ç™ºè€…ãŒæ‚ªã„ã¨è€ƒãˆã‚‹ğŸŒ¹)ã¨ã—ã¦ç„¡è¦–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

`()`ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªãƒ†ãƒ©ãƒ«ã‚’å›²ã‚€ã“ã¨ã§ä¿®æ­£ã§ãã¾ã™ï¼š

```ts
// Correct ğŸŒ¹
var foo = () => ({
    bar: 123
});
```
